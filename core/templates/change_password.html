<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Change Password - AgriBot</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <style>
        body { background: linear-gradient(135deg, #004e92, #000428); color: white; min-height: 100vh; }
        .sidebar { width: 250px; height: 100vh; position: fixed; background: rgba(0,0,0,0.2); backdrop-filter: blur(10px); }
        .nav-link { color: #ffffffb3; padding: 12px 25px; }
        .nav-link.active { background: rgba(255,255,255,0.1); color: white; border-left: 4px solid white; }
        .main-content { margin-left: 250px; padding: 50px; }
        .password-card { background: rgba(255,255,255,0.1); padding: 40px; border-radius: 15px; max-width: 500px; margin: auto; }
        .form-control { background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.2); color: white; margin-bottom: 20px; }
        .btn-change { background: #00d2ff; border: none; color: white; width: 100%; padding: 12px; font-weight: bold; }
        label { font-size: 0.8rem; color: #ccc; margin-bottom: 5px; display: block; }
    </style>
</head>
<body>
    <div class="sidebar">
        <nav class="nav flex-column">
            <div class="p-4 small fw-bold text-uppercase opacity-50">Main Navigation</div>
            <a class="nav-link {% if request.resolver_match.url_name == 'user_dashboard' %}active{% endif %}" href="{% url 'user_dashboard' %}">
                <i class="bi bi-grid me-2"></i> Dashboard
            </a>
            <a class="nav-link" href="{% url 'chatbot_init' %}"><i class="bi bi-chat-dots me-2"></i> Chatbot</a>

            <div class="p-4 small fw-bold text-uppercase opacity-50 mt-3">Account</div>
            <a class="nav-link {% if request.resolver_match.url_name == 'my_profile' %}active{% endif %}" href="{% url 'my_profile' %}">
                <i class="bi bi-person me-2"></i> My Profile
            </a>
            <a class="nav-link {% if request.resolver_match.url_name == 'edit_profile' %}active{% endif %}" href="{% url 'edit_profile' %}">
                <i class="bi bi-pencil me-2"></i> Edit Profile
            </a>
            <a class="nav-link {% if request.resolver_match.url_name == 'change_password' %}active{% endif %}" href="{% url 'change_password' %}">
                <i class="bi bi-lock me-2"></i> Change Password
            </a>

            <div class="p-4 small fw-bold text-uppercase opacity-50 mt-3">General</div>
            <a class="nav-link" href="{% url 'crop_details' %}"><i class="bi bi-credit-card-2-front me-2"></i> Crop Details</a>
            <a class="nav-link" href="{% url 'fertilizer_details' %}"><i class="bi bi-gift me-2"></i> Fertilizer Details</a>
            <a class="nav-link" href="#"><i class="bi bi-card-text me-2"></i> Feedback</a>
            
            <a class="nav-link mt-auto" href="{% url 'logout' %}">
                <i class="bi bi-box-arrow-right me-2"></i> Logout
            </a>
        </nav>
    </div>

    <div class="main-content">
        <div class="password-card">
            <h3 class="mb-4 text-center">Change Password</h3>
            {% if error %}
                <div class="alert alert-danger py-2 small text-center">{{ error }}</div>
            {% endif %}
            <form method="POST">
                {% csrf_token %}
                <label>Current Password</label>
                <input type="password" name="old_password" class="form-control" required>
                
                <label>New Password</label>
                <input type="password" name="new_password" class="form-control" required>
                
                <label>Confirm New Password</label>
                <input type="password" name="confirm_password" class="form-control" required>
                
                <button type="submit" class="btn-change mt-3">UPDATE PASSWORD</button>
            </form>
        </div>
    </div>

    <script>
        {% if pass_success %}
        Swal.fire({
            title: 'Success!',
            text: 'Password updated successfully',
            icon: 'success',
            confirmButtonColor: '#00d2ff'
        }).then(() => {
            window.location.href = "{% url 'user_dashboard' %}";
        });
        {% endif %}
    </script>
</body>
</html>